<!doctype html><html lang=en><head><title>How to connect Apple Magic Keyboard with multiple devices · Emanuele Viglianisi</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Emanuele Viglianisi"><meta name=description content="Connect the Apple Magic Keyboard with multiple device using Bluetooth"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to connect Apple Magic Keyboard with multiple devices"><meta name=twitter:description content="Connect the Apple Magic Keyboard with multiple device using Bluetooth"><meta property="og:url" content="https://viglianisi.eu/posts/magic-keyboard-pairing/"><meta property="og:site_name" content="Emanuele Viglianisi"><meta property="og:title" content="How to connect Apple Magic Keyboard with multiple devices"><meta property="og:description" content="Connect the Apple Magic Keyboard with multiple device using Bluetooth"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-27T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-27T00:00:00+00:00"><meta property="article:tag" content="Apple"><meta property="article:tag" content="Keyboards"><meta property="article:tag" content="Bluetooth"><meta property="article:tag" content="Scripts"><meta property="article:tag" content="Macos"><meta property="article:tag" content="Windows"><link rel=canonical href=https://viglianisi.eu/posts/magic-keyboard-pairing/><link rel=preload href=https://viglianisi.eu/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://viglianisi.eu/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://viglianisi.eu/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=https://viglianisi.eu/css/coder.min.365c48bee75c9fd4fd36d4155af8633b6de0e9a41357d8e557cffe510d80b685.css integrity="sha256-NlxIvudcn9T9NtQVWvhjO23g6aQTV9jlV8/+UQ2AtoU=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://viglianisi.eu/scss/custom.min.1e8eefdbd840c6f6680833f5aeac9691ac2752dd5cfd9024e8b1d360d83c5a6e.css integrity="sha256-Ho7v29hAxvZoCDP1rqyWkawnUt1c/ZAk6LHTYNg8Wm4=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=https://viglianisi.eu/images/favicon.svg sizes=any><link rel=icon type=image/png href=https://viglianisi.eu/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://viglianisi.eu/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=https://viglianisi.eu/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=https://viglianisi.eu/images/apple-touch-icon.png><link rel=manifest href=https://viglianisi.eu/site.webmanifest><link rel=mask-icon href=https://viglianisi.eu/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-light"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://viglianisi.eu/>Emanuele Viglianisi
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://viglianisi.eu/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://viglianisi.eu/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://viglianisi.eu/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href="https://docs.google.com/document/d/1qrQFRr6-voNLREhd0zHKwRxAH_RpErikrnpDnr8ZqP0/export?format=pdf">Curriculum (CV)</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://viglianisi.eu/posts/magic-keyboard-pairing/>How to connect Apple Magic Keyboard with multiple devices</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2023-09-27T00:00:00Z>September 27, 2023
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
5-minute read</span></div><div class=authors><i class="fa-solid fa-user" aria-hidden=true></i>
<a href=https://viglianisi.eu/authors/emanuele-viglianisi/>Emanuele Viglianisi</a></div><div class=categories><i class="fa-solid fa-folder" aria-hidden=true></i>
<a href=https://viglianisi.eu/categories/automation/>Automation</a>
<span class=separator>•</span>
<a href=https://viglianisi.eu/categories/customization/>Customization</a></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=https://viglianisi.eu/tags/apple/>Apple</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://viglianisi.eu/tags/keyboards/>Keyboards</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://viglianisi.eu/tags/bluetooth/>Bluetooth</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://viglianisi.eu/tags/scripts/>Scripts</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://viglianisi.eu/tags/macos/>Macos</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://viglianisi.eu/tags/windows/>Windows</a>
</span><span class=separator>•</span>
<span class=tag><a href=https://viglianisi.eu/tags/linux/>Linux</a></span></div></div></header><div class=post-content><h1 id=how-to-connect-apple-magic-keyboard-with-multiple-devices>How to connect Apple Magic Keyboard with multiple devices
<a class=heading-link href=#how-to-connect-apple-magic-keyboard-with-multiple-devices><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>Apple Magic Keyboard is one of the most famous / fun-to-use keyboards. I recently got one and wanted to use it with multiple computers and OS. In particular, I mainly use the keyboard connected via Bluetooth to my MacBook Pro, and I&rsquo;d like to use it with a computer that has both Windows and Ubuntu operative systems.</p><p>The Apple Magic Keyboard, differently than other competitors’ keyboards like Logitech MX Keys, does not support multiple devices. It can be paired just with one device at a time.</p><p>Every time I’d like to switch from Mac OS to Windows, for example, I need to:</p><ul><li>Open Bluetooth control panel</li><li>Forget the device</li><li>Search and pair again the device</li></ul><p>It is quite a tedious procedure, therefore I have tried to automate it as much as possible and this is what I have obtained.</p><h2 id=sharing-the-bluetooth-pairing-key>Sharing the Bluetooth pairing key
<a class=heading-link href=#sharing-the-bluetooth-pairing-key><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Following the procedure in this <a href=https://nelsonaloysio.medium.com/how-to-share-bluetooth-pairing-key-among-linux-macos-windows-2714ef40daff class=external-link target=_blank rel=noopener>article</a>, I have tried to share the same pairing key between Mac OS and Windows. However, it did not work for me - the device connects, but after a few seconds, it disconnects automatically.</p><p>I believe, the Keyboard registers the MAC address of the connected device and sticks with that until it is unpaired and paired again. Sharing the pairing key would work fine instead when you want to use the Keyboard with two OS in dual-boot.</p><h2 id=sharing-the-bluetooth-mac-address>Sharing the Bluetooth MAC address
<a class=heading-link href=#sharing-the-bluetooth-mac-address><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>If the MAC address is the problem, can the two devices share the same Bluetooth MAC address, so that the keyboard recognizes them as the same device? Yes, it could be an option. Some Bluetooth devices allow you to change the MAC address. However, the MAC address is designed to be unique, and it is not a good idea to have two devices with the same MAC address, also, not all the Bluetooth hardware supports changing MAC address. If you really want to try that, you can check out this <a href=https://macaddresschanger.com/ class=external-link target=_blank rel=noopener>program for Windows</a>.</p><h2 id=methods-for-a-fast-pairing-process>Methods for a fast pairing process
<a class=heading-link href=#methods-for-a-fast-pairing-process><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>After giving up finding a way for my keyboard to be recognized by all my devices and operative system without repeating the pairing process, I have focused on making that process easier, quick, and with the minimum number of clicks.</p><h3 id=mac-os><strong>Mac OS</strong>
<a class=heading-link href=#mac-os><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>I found that the fastest way to pair the Magic Keyboard to the Mac Book is just plugging it by using a simple Lightning cable. After connecting it, it is automatically paired and you can use it simply with Bluetooth.</p><p>Windows and Linux don’t have this functionality Bluetooth-pairing-by-plugging-a-cable functionality and I had to find another way.</p><p>If you prefer having a script like for Linux and Windows, you may want to use the command line tool <a href=https://github.com/toy/blueutil class=external-link target=_blank rel=noopener>https://github.com/toy/blueutil</a>.</p><h3 id=linux><strong>Linux</strong>
<a class=heading-link href=#linux><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>Make sure you have installed the <em>bluez</em> package</li></ul><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install bluez
</span></span></code></pre></div><ul><li>Find the Keyboard MAC address</li></ul><p>Turn off and turn on your Keyboard to turn the discovery mode. Then run the command</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bluetoothctl scan on
</span></span></code></pre></div><p>and note the MAC address (looks like 01:23:45:AB:CD:9F).</p><ul><li>Create a bash script:</li></ul><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#79c0ff>keyboard_mac</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;&lt;YOUR_KEYBOARD_MAC_ADDRESS&gt;&#34;</span>
</span></span><span style=display:flex><span>bluetoothctl remove <span style=color:#79c0ff>$keyboard_mac</span>
</span></span><span style=display:flex><span>sleep <span style=color:#a5d6ff>2</span>
</span></span><span style=display:flex><span>bluetoothctl agent on
</span></span><span style=display:flex><span>bluetoothctl default-agent
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stdbuf -oL bluetoothctl scan on | <span style=color:#ff7b72>while</span> <span style=color:#79c0ff>IFS</span><span style=color:#ff7b72;font-weight:700>=</span> read -r line; <span style=color:#ff7b72>do</span>
</span></span><span style=display:flex><span>    echo <span style=color:#79c0ff>$line</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># Check if the target string is present in the line using grep</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> <span style=color:#ff7b72;font-weight:700>[[</span> <span style=color:#79c0ff>$line</span> <span style=color:#ff7b72;font-weight:700>==</span> *<span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$keyboard_mac</span><span style=color:#a5d6ff>&#34;</span>* <span style=color:#ff7b72;font-weight:700>]]</span>; <span style=color:#ff7b72>then</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Found &#39;</span><span style=color:#79c0ff>$keyboard_mac</span><span style=color:#a5d6ff>&#39; in the output. Stopping the program...&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># Terminate the program gracefully</span>
</span></span><span style=display:flex><span>        pkill -P <span style=color:#79c0ff>$$</span>  <span style=color:#8b949e;font-style:italic># Terminate all child processes (including &#39;your_program&#39;)</span>
</span></span><span style=display:flex><span>        break
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>fi</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bluetoothctl trust <span style=color:#79c0ff>$keyboard_mac</span>
</span></span><span style=display:flex><span>bluetoothctl pair <span style=color:#79c0ff>$keyboard_mac</span>
</span></span><span style=display:flex><span>bluetoothctl connect <span style=color:#79c0ff>$keyboard_mac</span>
</span></span></code></pre></div><p>The script will remove the keyboard if already paired. Then will search again for the device and pair for it. During the <code>bluetoothctl pair</code> command the system will show you a prompt like “Do you want to connect this device with the PIN…” at this point, click Connect and the device will be immediately ready to be used.</p><p><em><strong>Important:</strong> you have to make the keyboard enter in the discovery mode. To do that, just turn it off and turn it on again.</em></p><p>I then created a Desktop shortcut with this configuration</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat magickeyboard.desktop 
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>[</span>Desktop Entry<span style=color:#ff7b72;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#79c0ff>Categories</span><span style=color:#ff7b72;font-weight:700>=</span>Application;
</span></span><span style=display:flex><span><span style=color:#79c0ff>Exec</span><span style=color:#ff7b72;font-weight:700>=</span>bash /home/emavgl/magickeyboard.bash
</span></span><span style=display:flex><span><span style=color:#79c0ff>Icon</span><span style=color:#ff7b72;font-weight:700>=</span>utilities-terminal
</span></span><span style=display:flex><span><span style=color:#79c0ff>Name</span><span style=color:#ff7b72;font-weight:700>=</span>Pair Magic Keyboard
</span></span></code></pre></div><p>Pairing the Keyboard is just as easy as:</p><ul><li>Turning off and On the Keyboard</li><li>Double Click on the program</li><li>Click <code>Accept</code> when prompted to pair the device</li></ul><h3 id=windows>Windows
<a class=heading-link href=#windows><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>A similar procedure is also possible on Windows.</p><ul><li>First, it is necessary to install <a href=https://bluetoothinstaller.com/bluetooth-command-line-tools class=external-link target=_blank rel=noopener>Bluetooth command line tools - work with bluetooth from the command line (bluetoothinstaller.com)</a> - when installing, ensure to enable the options to add the command to the PATH.</li><li>Find the Keyboard MAC address by opening the <code>cmd</code> and running the command <code>btdiscovery</code>. In a couple of seconds, you will see on the screen the list of the devices with their MAC address.</li></ul><p><em><strong>Important:</strong> you have to make the keyboard enter in the discovery mode. To do that, just turn it off and turn it on again.</em></p><ul><li>Create a bat file</li></ul><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>@ECHO</span><span style=color:#6e7681> </span>OFF<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>::<span style=color:#6e7681> </span>Store<span style=color:#6e7681> </span>the<span style=color:#6e7681> </span>MAC<span style=color:#6e7681> </span>address<span style=color:#6e7681> </span>in<span style=color:#6e7681> </span>a<span style=color:#6e7681> </span>variable<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>set<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;mac_address=&lt;KEYBOARD-MAC-ADDRESS-HERE&gt;&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>echo<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Remove association between COM port and a remote service&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>btcom<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-</span>b<span style=color:#a5d6ff>&#34;%mac_address%&#34;</span><span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-</span>r<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-</span>s1124<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>echo<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Unpair the device&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>btpair<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-</span>u<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-</span>b<span style=color:#a5d6ff>&#34;%mac_address%&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>echo<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Create association between COM port and a remote service&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>btcom<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-</span>b<span style=color:#a5d6ff>&#34;%mac_address%&#34;</span><span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-</span>c<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>-</span>s1124<span style=color:#6e7681>
</span></span></span></code></pre></div><p>Note that <code>1124</code> is the Bluetooth service code for the Keyboard (HumanInterfaceDeviceService). If you want to pair the headphones, you have to add voice service <code>111e</code>, and music <code>110b</code>. You can find <a href=https://www.bluetooth.com/specifications/assigned-numbers/ class=external-link target=_blank rel=noopener>here</a> the list of services.</p><p>Pairing the Keyboard is just as easy as:</p><ul><li>Turning off and On the Keyboard</li><li>Double Click on the .bat script</li><li>Click <code>Accept</code> when prompted to pair the device</li></ul><p>Finally, I can enjoy my Keyboard in all my devices. I hope this guide was also useful to you!</p></div><footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//https-emavgl-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}(),document.addEventListener("themeChanged",function(){document.readyState=="complete"&&DISQUS.reset({reload:!0,config:disqus_config})})</script></footer></article></section></div><footer class=footer><section class=container>©
2020 -
2025
Emanuele Viglianisi
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=https://viglianisi.eu/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script data-goatcounter=https://emavgl-github.goatcounter.com/count async src=//gc.zgo.at/count.js></script></body></html>